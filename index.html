<!DOCTYPE html>
<html lang="es">
<head>
  <link rel="stylesheet" href="paginita_de_ramiro.css">
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
<title>BROWNIESGARDEN</title>

<!-- Fuente -->
<link href="https://fonts.googleapis.com/css2?family=Sirukota&display=swap" rel="stylesheet">
<!-- Iconos -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
</head>
<body>

<header>
  <h1>BROWNIESGARDEN</h1>
  <nav>
    <a href="#inicio">Inicio</a>
    <a href="#productos">Productos</a>
    <a href="#beneficios">Beneficios</a>
    <a href="#testimonios">Testimonios</a>
    <a href="#informacion">Contacto</a>
  </nav>
</header>


<!-- Icono carrito -->
<div id="cart-icon"><i class="fas fa-shopping-cart"></i> <span id="cart-count">0</span></div>

<!-- Drawer Carrito -->
<div id="cart">
  <button id="close-cart"><i class="fas fa-times"></i></button>
  <h2>üõí Tu carrito</h2>
  <div id="cart-items"></div>
  <div id="cart-total">Total: $0 ARS</div>

  <!-- Mensaje de horario -->
  <div id="horario-pedidos" style="padding:10px;margin:10px 0;border-radius:12px;background:#fff4e7;color:#6a2d35;font-weight:bold;text-align:center;">
    üïë Pedidos disponibles de <br> 13:30 a 21:30
  </div>

  <div id="client-name" style="margin:8px 0 14px;">
    <label for="name"><b>Tu nombre</b></label>
    <input type="text" id="name" placeholder="Escrib√≠ tu nombre" style="width:100%;padding:10px;border:1px solid #ddd;border-radius:10px;">
  </div>

  <div id="payment-method">
    <label for="payment"><b>M√©todo de pago</b></label>
    <select id="payment">
      <option value="Efectivo">Efectivo</option>
      <option value="Transferencia">Transferencia</option>
      <option value="MercadoPago">MercadoPago</option>
    </select>
  </div>

  <div id="shipping-method" style="margin:8px 0 14px;">
    <label for="shipping"><b>M√©todo de env√≠o/retiro</b></label>
    <select id="shipping">
      <option value="Retiro en el local">Retiro en el local</option>
      <option value="Env√≠o a domicilio">Env√≠o a domicilio</option>
    </select>
  </div>

  <!-- ‚òÖ NUEVO: campo Direcci√≥n que aparece solo si eligen "Env√≠o a domicilio" -->
  <div id="address-field" style="display:none;margin:8px 0 14px;">
    <label for="address"><b>Direcci√≥n de entrega</b></label>
    <input type="text" id="address" placeholder="Calle, n√∫mero, piso/depto, barrio" style="width:100%;padding:10px;border:1px solid #ddd;border-radius:10px;">
  </div>
  <!-- ‚òÖ FIN NUEVO -->

  <!-- ‚ùñ AGREGADO: aviso de direcci√≥n de retiro (animado) -->
  <div id="pickup-hint">üìç Retiro en: <b>Av. Brown 123, Puerto Madryn</b></div>
  <!-- ‚ùñ FIN AGREGADO -->

  <div id="sendto-method" style="margin:8px 0 16px;">
    <label for="sendto"><b>Enviar pedido a</b></label>
    <select id="sendto">
      <option value="542804864819">WhatsApp 2804864819</option>
      <option value="542805069519">WhatsApp 2805069519</option>
    </select>
  </div>

  <button id="checkout" class="btn btn-primary" style="width:100%;">Finalizar pedido</button>
</div>





<!-- Modal Cantidad -->
<div id="modal">
  <div class="modal-card">
    <span class="modal-close" id="modalClose">&times;</span>
    <div class="modal-title" id="mNombre">Producto</div>
    <div class="modal-desc" id="mDesc">Descripci√≥n</div>
    <div class="modal-price">Precio: $<span id="mPrecio">0</span> ARS</div>

    <div class="qty-row">
      <button class="qty-btn" id="menos">-</button>
      <input type="number" id="cantidad" class="qty-input" min="1" value="1"/>
      <button class="qty-btn" id="mas">+</button>
    </div>

    <div class="modal-actions">
      <button class="btn btn-outline" id="cancelar">Cancelar</button>
      <button class="btn btn-primary" id="agregarCarrito">Agregar al carrito</button>
    </div>
  </div>
</div>

<!-- Hero -->
<section id="inicio">
  <div>
    <h2>¬°Bienvenidos a BROWNIESGARDEN!</h2>
    <p>Los brownies m√°s deliciosos, reci√©n horneados y con amor.</p>
    <button id="btnVerProductos">Ver Productos</button>
  </div>
</section>

<!-- Productos -->
<section id="productos">
  <h2>Nuestros Brownies</h2>
  <div class="productos-container">

    <!-- Classic One -->
    <article class="card" data-nombre="Classic One" data-precio="4000" data-descripcion="Brownie de chocolate relleno de salsa de avellanas y oreos." data-img="img/classic-one.jpg">
      <div class="img-wrap">
        <img src="https://i.imgur.com/NNmYOCC.jpeg" alt="Classic One">
        <span class="badge">$4000</span>
      </div>
      <div class="card-body">
        <h3>Classic One</h3>
        <p>Brownie de chocolate relleno de salsa de avellanas y oreos con por encima.</p>
        <div class="price">$4000 ARS</div>
        <div class="actions">
          <button class="btn btn-outline ver" type="button">Ver</button>
          <button class="btn btn-primary add" type="button">Agregar</button>
        </div>
      </div>
    </article>

    <!-- Red Forest -->
    <article class="card" data-nombre="Red Forest" data-precio="5000" data-descripcion="Red velvet con chips de chocolate blanco y frosting de queso crema." data-img="img/red-forest.jpg">
      <div class="img-wrap">
        <img src="https://i.imgur.com/8G2TyyG.jpeg" alt="Red Forest">
        <span class="badge">$5000</span>
      </div>
      <div class="card-body">
        <h3>Red Forest</h3>
        <p>Brownie de red velvet con chips de chocolate blanco y frosting de queso crema.</p>
        <div class="price">$5000 ARS</div>
        <div class="actions">
          <button class="btn btn-outline ver" type="button">Ver</button>
          <button class="btn btn-primary add" type="button">Agregar</button>
        </div>
      </div>
    </article>

    <!-- Tira-Miss U -->
    <article class="card" data-nombre="Tira-Miss U" data-precio="3000" data-descripcion="Chocolate con queso crema y galletitas vainillas como topping." data-img="img/tira-miss-u.jpg">
      <div class="img-wrap">
        <img src="https://i.imgur.com/s3B56O9.jpeg" alt="Tira-Miss U">
        <span class="badge">$3000</span>
      </div>
      <div class="card-body">
        <h3>Tira-Miss U</h3>
        <p>Brownie de chocolate con queso crema y galletitas vainillas como topping.</p>
        <div class="price">$3000 ARS</div>
        <div class="actions">
          <button class="btn btn-outline ver" type="button">Ver</button>
          <button class="btn btn-primary add" type="button">Agregar</button>
        </div>
      </div>
    </article>

    <!-- Carrot Type -->
    <article class="card" data-nombre="Carrot Type" data-precio="3800" data-descripcion="Carrot cake con chocolate blanco y frosting de queso crema." data-img="img/carrot-type.jpg">
      <div class="img-wrap">
        <img src="https://i.imgur.com/NNmYOCC.jpeg" alt="Carrot Type">
        <span class="badge">$3800</span>
      </div>
      <div class="card-body">
        <h3>Carrot Type</h3>
        <p>Brownie de torta carrot cake con chocolate blanco y frosting de queso crema.</p>
        <div class="price">$3800 ARS</div>
        <div class="actions">
          <button class="btn btn-outline ver" type="button">Ver</button>
          <button class="btn btn-primary add" type="button">Agregar</button>
        </div>
      </div>
    </article>

    <!-- Brookie -->
    <article class="card" data-nombre="Brookie" data-precio="4200" data-descripcion="Mezcla de brownie + masa de cookies con chips de chocolate negro." data-img="img/brookie.jpg">
      <div class="img-wrap">
        <img src="https://i.imgur.com/x0kooqt.jpeg" alt="Brookie">
        <span class="badge">$4200</span>
      </div>
      <div class="card-body">
        <h3>Brookie</h3>
        <p>Mezcla de brownie + masa de cookies con chips de chocolate negro.</p>
        <div class="price">$4200 ARS</div>
        <div class="actions">
          <button class="btn btn-outline ver" type="button">Ver</button>
          <button class="btn btn-primary add" type="button">Agregar</button>
        </div>
      </div>
    </article>

    <!-- Cookie Monster -->
    <article class="card" data-nombre="Cookie Monster" data-precio="4600" data-descripcion="Blue velvet con oreos + frosting y cookies chocolate chips." data-img="img/cookie-monster.jpg">
      <div class="img-wrap">
        <img src="https://i.imgur.com/VdCIvLr.jpeg" alt="Cookie Monster">
        <span class="badge">$4600</span>
      </div>
      <div class="card-body">
        <h3>Cookie Monster</h3>
        <p>Brownies de Blue velvet con oreos + frosting y cookies chocolate chips.</p>
        <div class="price">$4600 ARS</div>
        <div class="actions">
          <button class="btn btn-outline ver" type="button">Ver</button>
          <button class="btn btn-primary add" type="button">Agregar</button>
        </div>
      </div>
    </article>

    <!-- Dubai‚Äôs -->
    <article class="card" data-nombre="Dubai‚Äôs" data-precio="4800" data-descripcion="Centro de salsa de pistachos y chips de chocolate blanco." data-img="img/dubais.jpg">
      <div class="img-wrap">
        <img src="https://i.imgur.com/GpK3t2V.jpeg" alt="Dubai‚Äôs">
        <span class="badge">$4800</span>
      </div>
      <div class="card-body">
        <h3>Dubai‚Äôs</h3>
        <p>Brownie con centro de salsa de pistachos y chips de chocolate blanco.</p>
        <div class="price">$4800 ARS</div>
        <div class="actions">
          <button class="btn btn-outline ver" type="button">Ver</button>
          <button class="btn btn-primary add" type="button">Agregar</button>
        </div>
      </div>
    </article>

  </div>
</section>

<!-- Beneficios -->
<section id="beneficios">
  <div class="wrap">
    <h2>Beneficios</h2>
    <div class="beneficios-container">
      <div class="beneficio-card"><h3>Ingredientes Frescos</h3><p>Solo los mejores ingredientes para un sabor √∫nico.</p></div>
      <div class="beneficio-card"><h3>Recetas Artesanales</h3><p>Cada brownie est√° horneado con dedicaci√≥n y amor.</p></div>
      <div class="beneficio-card"><h3>Entrega R√°pida</h3><p>Recib√≠ tus brownies frescos directamente en tu casa.</p></div>
    </div>
  </div>
</section>

<!-- Testimonios -->
<section id="testimonios">
  <div class="wrap">
    <h2>Testimonios</h2>
    <div class="testimonios-container">
      <div class="testimonio-card">"Los brownies son espectaculares, nunca hab√≠a probado algo tan rico en Puerto Madryn." - Florencia</div>
      <div class="testimonio-card">"Excelente sabor y presentaci√≥n. Mi familia qued√≥ encantada." - Mart√≠n</div>
      <div class="testimonio-card">"Siempre frescos y deliciosos. No puedo dejar de pedirlos cada semana." - Luc√≠a</div>
    </div>
  </div>
</section>

<!-- Contacto -->
<section id="informacion">
  <div class="wrap" style="text-align:center;">
    <h2>Contacto</h2>
    <p><b>Tel:</b> 2804864819 - 2805069519</p>
    <p><b>Email:</b> zzoeyoguel@gmail.com - Ramirolanda98@gmail.com</p>
    <div class="redes" style="margin-top:12px;">
      <a href="https://www.instagram.com/browniesgarden.pm?igsh=MWd1MGRtMDhybDNhOA==" target="_blank">
        <i class="fab fa-instagram-square"></i> BROWNIESGARDEN
      </a>
    </div>
    <p style="margin-top:18px;font-size:1.15em;color:var(--rosa);">
      üì∏ Las fotos de nuestros brownies pod√©s verlas en nuestro Instagram.
    </p>
  </div>
</section>

<footer>
  <p>¬© 2025 BROWNIESGARDEN - Todos los derechos reservados üç´</p>
</footer>

<script>
/* Animaci√≥n secciones */
const secciones=document.querySelectorAll("section");
const obs=new IntersectionObserver(es=>{
  es.forEach(e=>{ if(e.isIntersecting) e.target.classList.add("visible"); });
},{threshold:.2});
secciones.forEach(s=>obs.observe(s));

/* Scroll a productos */
document.getElementById("btnVerProductos").addEventListener("click",()=>{
  document.getElementById("productos").scrollIntoView({behavior:"smooth"});
});

/* -------- Carrito -------- */
let cart=[];
const cartItems=document.getElementById("cart-items");
const cartTotal=document.getElementById("cart-total");
const cartCount=document.getElementById("cart-count");

/* ‚ùñ AGREGADO: direcci√≥n de retiro + variable env√≠o extra */
const PICKUP_ADDRESS = "Av. Brown 123, Puerto Madryn";
let envioExtra = 0;
/* ‚ùñ FIN AGREGADO */

function renderCart(){
  cartItems.innerHTML="";
  let total=0, count=0;
  cart.forEach((item,i)=>{
    const itemTotal=item.price*item.qty;
    total += itemTotal; count += item.qty;
    cartItems.insertAdjacentHTML("beforeend",`
      <div class="cart-item">
        <img src="${item.img}" alt="${item.name}">
        <div class="cart-info">
          <strong>${item.name}</strong>
          <small>$${item.price} x ${item.qty} = <b>$${itemTotal}</b></small>
        </div>
        <div class="cart-actions">
          <button onclick="changeQty(${i},-1)" title="Quitar">‚ûñ</button>
          <button onclick="changeQty(${i},1)" title="Sumar">‚ûï</button>
          <button onclick="removeItem(${i})" title="Eliminar">üóë</button>
        </div>
      </div>
    `);
  });
  cartTotal.textContent="Total: $"+total+" ARS";
  cartCount.textContent=count;

  /* ‚ùñ AGREGADO: sumar $800 si es env√≠o a domicilio y mostrarlo */
  try{
    const extra = (envioExtra||0);
    if(extra>0){
      const totalFinal = total + extra;
      cartTotal.textContent = "Total: $" + totalFinal + " ARS (incluye env√≠o $" + extra + ")";
    }
  }catch(_){}
  /* ‚ùñ FIN AGREGADO */
}
function changeQty(i,d){
  cart[i].qty += d;
  if(cart[i].qty<=0){ cart.splice(i,1); }
  renderCart();
}
function removeItem(i){ cart.splice(i,1); renderCart(); }

/* Abrir/cerrar carrito */
document.getElementById("cart-icon").onclick=()=>document.getElementById("cart").classList.add("active");
document.getElementById("close-cart").onclick=()=>document.getElementById("cart").classList.remove("active");

/* -------- Modal Cantidad -------- */
const modal=document.getElementById("modal");
const mNombre=document.getElementById("mNombre");
const mDesc=document.getElementById("mDesc");
const mPrecio=document.getElementById("mPrecio");
const cantidad=document.getElementById("cantidad");
const btnMenos=document.getElementById("menos");
const btnMas=document.getElementById("mas");
const btnAgregar=document.getElementById("agregarCarrito");
const btnCancelar=document.getElementById("cancelar");
const btnCerrar=document.getElementById("modalClose");

let prodSel=null;
function abrirModal(data){
  prodSel = data;
  mNombre.textContent=data.nombre;
  mDesc.textContent=data.descripcion;
  mPrecio.textContent=data.precio;
  cantidad.value=1;
  modal.style.display="flex";
}
function cerrarModal(){ modal.style.display="none"; }

btnMenos.onclick=()=>{ if(+cantidad.value>1) cantidad.value=+cantidad.value-1; }
btnMas.onclick=()=>{ cantidad.value=+cantidad.value+1; }
btnCancelar.onclick=btnCerrar.onclick=()=>cerrarModal();
window.addEventListener("click",e=>{ if(e.target===modal) cerrarModal(); });

btnAgregar.onclick=()=>{
  const qty=parseInt(cantidad.value)||1;
  const existing=cart.find(p=>p.name===prodSel.nombre);
  if(existing){ existing.qty += qty; }
  else{ cart.push({name:prodSel.nombre,price:+prodSel.precio,qty,img:prodSel.img}); }
  renderCart();
  cerrarModal();
  document.getElementById("cart").classList.add("active");
};

/* Bind de tarjetas */
document.querySelectorAll(".card").forEach(card=>{
  const data={
    nombre:card.dataset.nombre,
    precio:card.dataset.precio,
    descripcion:card.dataset.descripcion,
    img:card.dataset.img
  };
  card.querySelector(".add").addEventListener("click",()=>abrirModal(data));
  card.querySelector(".ver").addEventListener("click",()=>abrirModal(data));
});

/* ‚òÖ NUEVO: mostrar/ocultar campo Direcci√≥n seg√∫n m√©todo de env√≠o */
const shippingSelect = document.getElementById("shipping");
const addressField = document.getElementById("address-field");
/* ‚ùñ AGREGADO: referencia al hint de retiro */
const pickupHint = document.getElementById("pickup-hint");
/* ‚ùñ FIN AGREGADO */
function toggleAddressField(){
  if(shippingSelect.value === "Env√≠o a domicilio"){
    addressField.style.display = "block";
    /* ‚ùñ AGREGADO */
    if(pickupHint) pickupHint.style.display = "none";
    envioExtra = 800;
    /* ‚ùñ FIN AGREGADO */
  } else {
    addressField.style.display = "none";
    /* ‚ùñ AGREGADO */
    if(pickupHint){
      pickupHint.style.display = "block";
      pickupHint.style.animation = "pop .35s ease";
    }
    envioExtra = 0;
    /* ‚ùñ FIN AGREGADO */
  }
  /* ‚ùñ AGREGADO: recalcular total al cambiar m√©todo */
  try{ renderCart(); }catch(_){}
  /* ‚ùñ FIN AGREGADO */
}
shippingSelect.addEventListener("change", toggleAddressField);
toggleAddressField();
/* ‚òÖ FIN NUEVO */

/* ‚òÖ NUEVO: control de horario (13:30 a 21:30) -> oculta bot√≥n fuera de horario */
function estaDentroDeHorario(){
  const ahora=new Date();
  const mins=ahora.getHours()*60 + ahora.getMinutes();
  const inicio=13*60 + 30; // 13:30
  const fin=21*60 + 30;    // 21:30
  return mins>=inicio && mins<=fin;
}
function aplicarEstadoHorario(){
  const abierto=estaDentroDeHorario();
  const btn=document.getElementById("checkout");
  const aviso=document.getElementById("horario-pedidos");
  if(btn){
    btn.style.display = abierto ? "block" : "none"; // desaparece fuera de horario
  }
  if(aviso){
    if(abierto){
      aviso.style.background="#e7f8e7";
      aviso.style.color="#2d6a2d";
      aviso.innerHTML="üü¢ Pedidos abiertos<br>Horario: 13:30 a 21:30";
    }else{
      aviso.style.background="#fbe4e4";
      aviso.style.color="#a22";
      aviso.innerHTML="üõë Pedidos cerrados<br>Horario: 13:30 a 21:30";
    }
  }
}
aplicarEstadoHorario();
setInterval(aplicarEstadoHorario, 60000);
/* ‚òÖ FIN NUEVO */

/* Checkout -> WhatsApp */
document.getElementById("checkout").onclick=()=>{
  /* ‚òÖ Seguridad adicional: si est√° fuera de horario, no deja avanzar */
  if(!estaDentroDeHorario()){
    alert("üö´ Estamos fuera de horario de pedidos (13:30 a 21:30). ¬°Te esperamos luego! üíï");
    aplicarEstadoHorario();
    return;
  }

  if(cart.length===0){ alert("Tu carrito est√° vac√≠o üòÖ"); return; }

  const name=document.getElementById("name").value.trim();
  if(!name){ alert("Por fa, pon√© tu nombre ‚úçÔ∏è"); return; }

  const code="ORD-"+String(Math.floor(Math.random()*100000)).padStart(5,"0");
  const method=document.getElementById("payment").value;
  const shipping=document.getElementById("shipping").value;
  const sendTo=document.getElementById("sendto").value;

  /* ‚òÖ NUEVO: tomar direcci√≥n si es env√≠o a domicilio */
  let addressText="";
  if(shipping==="Env√≠o a domicilio"){
    const addr=(document.getElementById("address").value||"").trim();
    if(!addr){
      alert("üì¶ Ingres√° la direcci√≥n para el env√≠o a domicilio, por favor.");
      return;
    }
    addressText = addr;
  }
  /* ‚òÖ FIN NUEVO */

  let total=0;
  let msg="üç´ *Pedido BROWNIESGARDEN*\\n\\n";
  msg += `üë§ *Cliente:* ${name}\\n`;
  msg += `üÜî *Pedido:* ${code}\\n\\n`;

  cart.forEach(it=>{
    const line=it.price*it.qty; total+=line;
    msg += `üëâ ${it.name} x${it.qty} = $${line}\\n`;
  });

  msg += `\\nüí∞ *Total:* $${total} ARS`;
  msg += `\\nüí≥ *Pago:* ${method}`;
  msg += `\\nüöö *Env√≠o/Retiro:* ${shipping}`;

  /* ‚òÖ NUEVO: agregar direcci√≥n al mensaje si corresponde */
  if(addressText){
    msg += `\\nüè† *Direcci√≥n:* ${addressText}`;
  }
  /* ‚òÖ FIN NUEVO */

  /* ‚ùñ AGREGADO: costo de env√≠o + direcci√≥n de retiro + total final */
  if(shipping==="Env√≠o a domicilio"){
    msg += `\\nüì¶ *Env√≠o:* +$800`;
  }else{
    msg += `\\nüìç *Retiro en:* ${PICKUP_ADDRESS}`;
  }
  const totalFinal = total + (shipping==="Env√≠o a domicilio" ? 800 : 0);
  if(totalFinal !== total){
    msg += `\\nüßæ *Total final:* $${totalFinal} ARS`;
  }
  /* ‚ùñ FIN AGREGADO */

  msg += `\\n\\nüôå ¬°Gracias por tu compra, ${name}! Nos vemos pronto üíï`;

  /* ‚òÖ‚òÖ A√ëADIDO (SIN BORRAR NADA): Re-formateo VERTICAL del mensaje con separadores */
  (()=>{
    let totalV = 0;
    let msgV = "üç´ *Pedido BROWNIESGARDEN*\n\n";
    msgV += `üë§ *Cliente:* ${name}\n`;
    msgV += `üÜî *Pedido:* ${code}\n\n`;

    cart.forEach(it=>{
      const line = it.price * it.qty; totalV += line;
      msgV += `üëâ ${it.name}\n   Cantidad: ${it.qty}\n   Subtotal: $${line}\n`;
      msgV += `‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ\n`;
    });

    msgV += `\nüí∞ *Total productos:* $${totalV} ARS\n`;
    msgV += `üí≥ *Pago:* ${method}\n`;
    msgV += `üöö *Env√≠o/Retiro:* ${shipping}\n`;

    if(addressText){
      msgV += `üè† *Direcci√≥n:* ${addressText}\n`;
    }

    if(shipping==="Env√≠o a domicilio"){
      msgV += `üì¶ *Env√≠o:* +$800\n`;
    }else{
      msgV += `üìç *Retiro en:* ${PICKUP_ADDRESS}\n`;
    }

    const totalFinalV = totalV + (shipping==="Env√≠o a domicilio" ? 800 : 0);
    if(totalFinalV !== totalV){
      msgV += `üßæ *Total final:* $${totalFinalV} ARS\n`;
    }

    msgV += `\nüôå ¬°Gracias por tu compra, ${name}! Nos vemos pronto üíï`;

    /* Sobrescribimos el mensaje final a enviar, pero SIN borrar las l√≠neas anteriores */
    msg = msgV;
  })();
  /* ‚òÖ‚òÖ FIN A√ëADIDO */

  const url=`https://wa.me/${sendTo}?text=${encodeURIComponent(msg)}`;
  window.open(url,"_blank");
};



/* Contador inicia en 0 */
renderCart();
</script>

<!-- =================================================================== -->
<!-- ‚òÖ‚òÖ AGREGADO SIN MODIFICAR NADA: Fly-to-cart (CSS + JS) ‚òÖ‚òÖ -->
<!-- =================================================================== -->

<script>
/* ========= Fly-to-cart: listeners y animaci√≥n (todo agregado) ========= */

/* Guardamos la √∫ltima card clickeada (Ver/Agregar) para saber el origen */
let lastClickedCard = null;
document.querySelectorAll(".card .add, .card .ver").forEach(btn=>{
  btn.addEventListener("click", (e)=>{
    lastClickedCard = e.currentTarget.closest(".card");
  });
});

/* Funci√≥n que hace volar una imagen hacia el icono del carrito */
function flyToCartFrom(el){
  try{
    const img = el.tagName === "IMG" ? el : el.querySelector("img");
    if(!img) return;

    const cartIcon = document.getElementById("cart-icon");
    const imgRect  = img.getBoundingClientRect();
    const cartRect = cartIcon.getBoundingClientRect();

    const clone = img.cloneNode(true);
    clone.classList.add("flying-img");
    clone.style.left = imgRect.left + "px";
    clone.style.top  = imgRect.top  + "px";
    clone.style.width  = imgRect.width + "px";
    clone.style.height = imgRect.height + "px";
    clone.style.transform = "translate(0,0) scale(1)";
    clone.style.opacity = "1";
    document.body.appendChild(clone);

    requestAnimationFrame(()=>{
      const toX = cartRect.left + cartRect.width/2 - (imgRect.left + imgRect.width/2);
      const toY = cartRect.top  + cartRect.height/2 - (imgRect.top  + imgRect.height/2);
      clone.style.transform = `translate(${toX}px, ${toY}px) scale(0.1)`;
      clone.style.opacity = "0.4";
      clone.style.width  = imgRect.width*0.1 + "px";
      clone.style.height = imgRect.height*0.1 + "px";
    });

    clone.addEventListener("transitionend", ()=>{
      clone.remove();
      cartIcon.classList.add("bump");
      setTimeout(()=>cartIcon.classList.remove("bump"), 450);
    }, { once:true });
  }catch(_){}
}

/* Resuelve la imagen origen: la √∫ltima card clickeada, o busca por prodSel.img */
function flyToCart(){
  let sourceImg = null;
  if(lastClickedCard){
    sourceImg = lastClickedCard.querySelector("img");
  }
  if(!sourceImg && typeof prodSel === "object" && prodSel && prodSel.img){
    const sel = document.querySelector(`img[src="${prodSel.img}"]`);
    if(sel) sourceImg = sel;
  }
  if(sourceImg) flyToCartFrom(sourceImg);
}

/* Disparo: cuando se hace click en "Agregar al carrito" del modal */
document.getElementById("agregarCarrito").addEventListener("click", ()=>{
  flyToCart();
});
</script>
<!-- =================================================================== -->

</body>
</html>
 